{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/CAELOS JR 2018/Documents/Proyecto StockTaking/Stocktaking-G2/Cliente/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { HttpErrorResponse } from '@angular/common/http';\nimport { catchError } from 'rxjs/operators';\nimport { of } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"src/app/services/authentication/auth.service\";\nexport class ObtenerPermisosService {\n  constructor(http, auth) {\n    this.http = http;\n    this.auth = auth;\n    this.listaPermisos = [];\n    this.listaLocales = [];\n  }\n  permisosDisponibles(servicio) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      _this.listaPermisos = yield _this.getPermisosSafe(servicio);\n      let codigoPermiso = _this.listaPermisos.map(permiso => _this.obtenerCodigoPermiso(permiso.nivelId));\n      return codigoPermiso;\n    })();\n  }\n  localesDisponibles(servicio) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      _this2.listaPermisos = yield _this2.getPermisosSafe(servicio);\n      let listaLocalestemp = _this2.listaPermisos[0].locales;\n      _this2.listaLocales = listaLocalestemp.split(\",\").map(numero => Number(numero));\n      return _this2.listaLocales;\n    })();\n  }\n  lineasDisponibles(servicio) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      _this3.listaPermisos = yield _this3.getPermisosSafe(servicio);\n      let listaLineastemp = _this3.listaPermisos[0].lineas;\n      return listaLineastemp;\n    })();\n  }\n  permisosNivel(servicio) {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      _this4.listaPermisos = yield _this4.getPermisosSafe(servicio);\n      const booleanos = [false, false, false];\n      _this4.listaPermisos.forEach(elemento => {\n        const nivelId = elemento.nivelId.toString();\n        const ultimosDosDigitos = nivelId.slice(-2);\n        if (ultimosDosDigitos === \"50\") {\n          booleanos[0] = true;\n        }\n        if (ultimosDosDigitos === \"51\") {\n          booleanos[1] = true;\n        }\n        if (ultimosDosDigitos === \"54\" || ultimosDosDigitos === \"52\") {\n          booleanos[2] = true;\n        }\n      });\n      return booleanos;\n    })();\n  }\n  permisoCostoUnitario(servicio) {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      let permiso = false;\n      _this5.listaPermisos = yield _this5.getPermisosSafe(servicio);\n      _this5.listaPermisos.forEach(elemento => {\n        const nivelId = elemento.nivelId.toString();\n        const ultimosDosDigitos = nivelId.slice(-2);\n        if (ultimosDosDigitos === \"60\") {\n          permiso = true;\n        }\n      });\n      return permiso;\n    })();\n  }\n  getPermisosSafe(servicio) {\n    var _this6 = this;\n    return _asyncToGenerator(function* () {\n      return new Promise((resolve, reject) => {\n        _this6.http.get(\"http://oasysweb.saia.com.ec/andina/api/seguridad/nivel/\" + servicio) //prueba usuario no autorizado\n        .pipe(catchError(error => of(error))).subscribe(res => {\n          if (res instanceof HttpErrorResponse) reject({\n            error: res.error,\n            status: res.status\n          });else resolve(res);\n        });\n      });\n    })();\n  }\n  obtenerCodigoPermiso(nivelId) {\n    const ultimosNumeros = nivelId.slice(-2);\n    return ultimosNumeros.toString();\n  }\n}\nObtenerPermisosService.ɵfac = function ObtenerPermisosService_Factory(t) {\n  return new (t || ObtenerPermisosService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.AuthService));\n};\nObtenerPermisosService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: ObtenerPermisosService,\n  factory: ObtenerPermisosService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":"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","names":["HttpErrorResponse","catchError","of","ObtenerPermisosService","constructor","http","auth","permisosDisponibles","servicio","listaPermisos","getPermisosSafe","codigoPermiso","map","permiso","obtenerCodigoPermiso","nivelId","localesDisponibles","listaLocalestemp","locales","listaLocales","split","numero","Number","lineasDisponibles","listaLineastemp","lineas","permisosNivel","booleanos","forEach","elemento","toString","ultimosDosDigitos","slice","permisoCostoUnitario","Promise","resolve","reject","get","pipe","error","subscribe","res","status","ultimosNumeros","factory","providedIn"],"sourceRoot":"","sources":["C:\\Users\\CAELOS JR 2018\\Documents\\Proyecto StockTaking\\Stocktaking-G2\\Cliente\\src\\app\\services\\obtener-permisos.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { HttpClient, HttpErrorResponse, HttpHeaders } from '@angular/common/http';\r\nimport { catchError } from 'rxjs/operators'\r\nimport { of } from 'rxjs';\r\nimport { AuthService } from 'src/app/services/authentication/auth.service';\r\nimport { Permiso } from 'src/app/interfaces/permiso';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ObtenerPermisosService {\r\n\r\n  private listaPermisos: Permiso[] = [];\r\n  private listaLocales: number[] = [];\r\n\r\n  constructor(private http: HttpClient, private auth: AuthService) { }\r\n\r\n  async permisosDisponibles(servicio: String) {\r\n    this.listaPermisos = await this.getPermisosSafe(servicio);\r\n    let codigoPermiso = this.listaPermisos.map(permiso => this.obtenerCodigoPermiso(permiso.nivelId));\r\n    return codigoPermiso;\r\n  }\r\n\r\n  async localesDisponibles(servicio: String) {\r\n    this.listaPermisos = await this.getPermisosSafe(servicio);\r\n    let listaLocalestemp = this.listaPermisos[0].locales;\r\n    this.listaLocales = listaLocalestemp.split(\",\").map(numero => Number(numero));\r\n    return this.listaLocales\r\n  }\r\n\r\n  async lineasDisponibles(servicio: String) {\r\n    this.listaPermisos = await this.getPermisosSafe(servicio);\r\n    let listaLineastemp = this.listaPermisos[0].lineas;\r\n    return listaLineastemp;\r\n  }\r\n\r\n  async permisosNivel(servicio: String) {\r\n    this.listaPermisos = await this.getPermisosSafe(servicio);\r\n    const booleanos: boolean[] = [false, false, false,];\r\n    this.listaPermisos.forEach((elemento) => {\r\n      const nivelId = elemento.nivelId.toString();\r\n      const ultimosDosDigitos = nivelId.slice(-2);\r\n      if (ultimosDosDigitos === \"50\") {\r\n        booleanos[0] = true;\r\n      }\r\n      if (ultimosDosDigitos === \"51\") {\r\n        booleanos[1] = true;\r\n      }\r\n      if (ultimosDosDigitos === \"54\" || ultimosDosDigitos === \"52\") {\r\n        booleanos[2] = true;\r\n      }\r\n    });\r\n    return booleanos;\r\n  }\r\n\r\n  async permisoCostoUnitario(servicio: String) {\r\n    let permiso = false;\r\n    this.listaPermisos = await this.getPermisosSafe(servicio);\r\n    this.listaPermisos.forEach((elemento) => {\r\n      const nivelId = elemento.nivelId.toString();\r\n      const ultimosDosDigitos = nivelId.slice(-2);\r\n      if (ultimosDosDigitos === \"60\") {\r\n        permiso = true;\r\n      }\r\n    });\r\n   return permiso; \r\n}\r\n\r\n  async getPermisosSafe(servicio: String) {\r\n    return new Promise<any>((resolve, reject) => {\r\n      this.http.get(\"http://oasysweb.saia.com.ec/andina/api/seguridad/nivel/\" + servicio) //prueba usuario no autorizado\r\n        .pipe(catchError((error) => of(error)))\r\n        .subscribe((res) => {\r\n          if (res instanceof HttpErrorResponse)\r\n            reject({ error: res.error, status: res.status });\r\n          else\r\n            resolve(res);\r\n        });\r\n    });\r\n  }\r\n\r\n  private obtenerCodigoPermiso(nivelId: string): string {\r\n    const ultimosNumeros = nivelId.slice(-2);\r\n    return ultimosNumeros.toString();\r\n  }\r\n\r\n}\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}